import{u as e,r,g as i,j as s,B as a,m as n}from"./index-aeca932e.js";import{F as o}from"./index-85dc0d3a.js";import{I as l}from"./index-d90fa46f.js";import{o as d}from"./order-e3583410.js";import{u as c}from"./useSetState-8e08c7f5.js";import{M as m}from"./index-6226197c.js";import"./responsiveObserve-cfbf1a72.js";import"./index-73995e0d.js";import"./EyeOutlined-f0ed5c3d.js";import"./ActionButton-04036752.js";import"./Portal-0dc81ff6.js";import"./getScrollBarSize-6b2349d8.js";const x=()=>{document.title="场地管理",e();const[x,p]=r.useState([]);let[u,h]=i();const j=u.get("field"),g=u.get("men"),y=u.get("dai"),[w,f]=r.useState(!1),[S,k]=r.useState(!1),[v,K]=r.useState([]),[b,F]=r.useState(),[C,$]=r.useState("");r.useEffect((()=>{$(JSON.stringify(x))}),[x]);const A=(e,t)=>{const r=v.some((r=>r.rowKey===t&&r.columnKey===e.week)),i=e.weekarr[t].explain;return r?"rgb(161, 211, 254)":0!=i?"rgb(162, 225, 248)":"rgb(234, 234, 234)"},[O,P]=r.useState(!1),B=e=>`星期${["","一","二","三","四","五","六","日"][e]}`,E=new Date,I=E.getFullYear(),D=E.getMonth()+1,M=E.getDate(),[N,T]=c({time:I+"-"+(D<10?"0"+D:D)+"-"+(M<10?"0"+M:M),coachuuid:j});return r.useEffect((()=>{(async()=>{const e={stationuuid:j};f(!0);try{const r=await d.stationPrice(e);r&&200===r.code?p(r.data):n.error((null==r?void 0:r.message)??t("dataFetchFailed"))}finally{f(!1)}})()}),[N]),s.jsx(s.Fragment,{children:s.jsxs("div",{children:[s.jsx("div",{style:{height:"30px"},children:S&&s.jsx(a,{type:"primary",onClick:()=>{P(!0)},children:"设置价格"})}),s.jsx("div",{children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{style:{width:"60px"}}),x.map(((e,t)=>s.jsxs("th",{style:{width:"200px"},children:[s.jsx("div",{children:B(e.week)}),s.jsx("div",{children:e.time})]},t)))]})}),s.jsx("tbody",{children:Array.from({length:24},((e,t)=>s.jsxs("tr",{children:[s.jsx("td",{style:{width:"60px",height:"60px"},children:s.jsx("div",{style:{marginTop:"-30px",textAlign:"right",paddingRight:"8px"},children:` ${t.toString().padStart(2,"0")}:00`})}),x.map(((e,r)=>s.jsx("td",{style:{backgroundColor:A(e,t),textAlign:"center",border:"1px solid #fff",padding:"20px 0"},id:`cell-${t}-${e.week}`,onClick:()=>((e,t)=>{const r={rowKey:t,columnKey:e.week},i=v.findIndex((e=>e.rowKey===r.rowKey&&e.columnKey===r.columnKey));-1===i?(k(!0),K([...v,r])):K(v.filter(((e,t)=>t!==i)))})(e,t),children:0==e.weekarr[t].explain?"无服务":e.weekarr[t].explain},r)))]},t)))})]})}),s.jsx(m,{open:O,onOk:async()=>{P(!1);const e={provideruuid:y,storeuuid:g,stationuuid:j,pricedata:C};f(!0);try{const r=await d.setStationPrice(e);r&&200===r.code?(p(r.data),window.location.reload()):n.error((null==r?void 0:r.message)??t("dataFetchFailed"))}finally{f(!1)}},onCancel:()=>{P(!1)},title:"设置价格",children:s.jsx(o,{className:"price-form",children:s.jsx(o.Item,{label:"价格",children:s.jsx(l,{style:{width:100},value:b,onChange:e=>{if(F(e.target.value),v.length>0){const t=x.map((t=>({...t,weekarr:t.weekarr.map(((r,i)=>{const s=i;return v.some((e=>e.rowKey===s&&e.columnKey===t.week))?{...r,explain:e.target.value}:r}))})));p(t)}},placeholder:"请输入价格"})})})})]})})};export{x as default};
