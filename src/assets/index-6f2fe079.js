import{r as e,_ as t,s as a,E as n,a4 as o,q as r,H as s,a5 as i,v as l,K as c,a6 as u,a7 as d,C as m,a8 as p,a9 as v,V as f,Z as h,b as y,e as g,h as x,j as b,T as k,S as C,B as N,m as S}from"./index-aeca932e.js";import{a as j}from"./index-801a9590.js";import"./index-d93151a5.js";import"./index-d90fa46f.js";import"./index-5a025839.js";import"./index-fb057fd6.js";import{D as E}from"./index-a0588428.js";import{D as M}from"./index-d88d2b2a.js";import"./index-57f63cdf.js";import{u as w}from"./user-a3dc1d16.js";import{g as D}from"./game-5b925b0c.js";import{s as Y}from"./server-78efb863.js";import{u as O}from"./useSetState-8e08c7f5.js";import{P as I}from"./Portal-0dc81ff6.js";import{E as T}from"./EyeOutlined-d33bc3ff.js";import{S as K}from"./SearchOutlined-fa850377.js";import"./index-5bcf51a7.js";import"./getScrollBarSize-6b2349d8.js";import"./isEqual-89fb4070.js";import"./useForceUpdate-c2b76191.js";import"./index-4a60c0a0.js";import"./index-73995e0d.js";import"./EyeOutlined-f0ed5c3d.js";import"./responsiveObserve-cfbf1a72.js";import"./CalendarOutlined-8ff6678f.js";var L=e.createContext(null),R=function(o){var r=o.prefixCls,s=o.className,i=o.style,l=o.children,c=o.containerRef,u=o.id,d={onMouseEnter:o.onMouseEnter,onMouseOver:o.onMouseOver,onMouseLeave:o.onMouseLeave,onClick:o.onClick,onKeyDown:o.onKeyDown,onKeyUp:o.onKeyUp};return e.createElement(e.Fragment,null,e.createElement("div",t({id:u,className:a("".concat(r,"-content"),s),style:n({},i),"aria-modal":"true",role:"dialog",ref:c},d),l))};function z(e){return"string"==typeof e&&String(Number(e))===e?(o(!1,"Invalid value type of `width` or `height` which should be number type instead."),Number(e)):e}var P={width:0,height:0,overflow:"hidden",outline:"none",position:"absolute"};function A(o,u){var d,m,p,v,f=o.prefixCls,h=o.open,y=o.placement,g=o.inline,x=o.push,b=o.forceRender,k=o.autoFocus,C=o.keyboard,N=o.rootClassName,S=o.rootStyle,j=o.zIndex,E=o.className,M=o.id,w=o.style,D=o.motion,Y=o.width,O=o.height,I=o.children,T=o.contentWrapperStyle,K=o.mask,A=o.maskClosable,U=o.maskMotion,V=o.maskClassName,F=o.maskStyle,H=o.afterOpenChange,B=o.onClose,$=o.onMouseEnter,_=o.onMouseOver,W=o.onMouseLeave,X=o.onClick,q=o.onKeyDown,Q=o.onKeyUp,J=e.useRef(),Z=e.useRef(),G=e.useRef();e.useImperativeHandle(u,(function(){return J.current}));e.useEffect((function(){var e;h&&k&&(null===(e=J.current)||void 0===e||e.focus({preventScroll:!0}))}),[h]);var ee=e.useState(!1),te=r(ee,2),ae=te[0],ne=te[1],oe=e.useContext(L),re=null!==(d=null!==(m=null===(p=!1===x?{distance:0}:!0===x?{}:x||{})||void 0===p?void 0:p.distance)&&void 0!==m?m:null==oe?void 0:oe.pushDistance)&&void 0!==d?d:180,se=e.useMemo((function(){return{pushDistance:re,push:function(){ne(!0)},pull:function(){ne(!1)}}}),[re]);e.useEffect((function(){var e,t;h?null==oe||null===(e=oe.push)||void 0===e||e.call(oe):null==oe||null===(t=oe.pull)||void 0===t||t.call(oe)}),[h]),e.useEffect((function(){return function(){var e;null==oe||null===(e=oe.pull)||void 0===e||e.call(oe)}}),[]);var ie=K&&e.createElement(s,t({key:"mask"},U,{visible:h}),(function(t,o){var r=t.className,s=t.style;return e.createElement("div",{className:a("".concat(f,"-mask"),r,V),style:n(n({},s),F),onClick:A&&h?B:void 0,ref:o})})),le="function"==typeof D?D(y):D,ce={};if(ae&&re)switch(y){case"top":ce.transform="translateY(".concat(re,"px)");break;case"bottom":ce.transform="translateY(".concat(-re,"px)");break;case"left":ce.transform="translateX(".concat(re,"px)");break;default:ce.transform="translateX(".concat(-re,"px)")}"left"===y||"right"===y?ce.width=z(Y):ce.height=z(O);var ue={onMouseEnter:$,onMouseOver:_,onMouseLeave:W,onClick:X,onKeyDown:q,onKeyUp:Q},de=e.createElement(s,t({key:"panel"},le,{visible:h,forceRender:b,onVisibleChanged:function(e){null==H||H(e)},removeOnLeave:!1,leavedClassName:"".concat(f,"-content-wrapper-hidden")}),(function(r,s){var l=r.className,c=r.style;return e.createElement("div",t({className:a("".concat(f,"-content-wrapper"),l),style:n(n(n({},ce),c),T)},i(o,{data:!0})),e.createElement(R,t({id:M,containerRef:s,prefixCls:f,className:E,style:w},ue),I))})),me=n({},S);return j&&(me.zIndex=j),e.createElement(L.Provider,{value:se},e.createElement("div",{className:a(f,"".concat(f,"-").concat(y),N,(v={},l(v,"".concat(f,"-open"),h),l(v,"".concat(f,"-inline"),g),v)),style:me,tabIndex:-1,ref:J,onKeyDown:function(e){var t=e.keyCode,a=e.shiftKey;switch(t){case c.TAB:var n;if(t===c.TAB)if(a||document.activeElement!==G.current){if(a&&document.activeElement===Z.current){var o;null===(o=G.current)||void 0===o||o.focus({preventScroll:!0})}}else null===(n=Z.current)||void 0===n||n.focus({preventScroll:!0});break;case c.ESC:B&&C&&(e.stopPropagation(),B(e))}}},ie,e.createElement("div",{tabIndex:0,ref:Z,style:P,"aria-hidden":"true","data-sentinel":"start"}),de,e.createElement("div",{tabIndex:0,ref:G,style:P,"aria-hidden":"true","data-sentinel":"end"})))}var U=e.forwardRef(A),V=function(t){var a=t.open,o=void 0!==a&&a,s=t.prefixCls,i=void 0===s?"rc-drawer":s,l=t.placement,c=void 0===l?"right":l,d=t.autoFocus,m=void 0===d||d,p=t.keyboard,v=void 0===p||p,f=t.width,h=void 0===f?378:f,y=t.mask,g=void 0===y||y,x=t.maskClosable,b=void 0===x||x,k=t.getContainer,C=t.forceRender,N=t.afterOpenChange,S=t.destroyOnClose,j=t.onMouseEnter,E=t.onMouseOver,M=t.onMouseLeave,w=t.onClick,D=t.onKeyDown,Y=t.onKeyUp,O=e.useState(!1),T=r(O,2),K=T[0],L=T[1],R=e.useState(!1),z=r(R,2),P=z[0],A=z[1];u((function(){A(!0)}),[]);var V=!!P&&o,F=e.useRef(),H=e.useRef();u((function(){V&&(H.current=document.activeElement)}),[V]);if(!C&&!K&&!V&&S)return null;var B={onMouseEnter:j,onMouseOver:E,onMouseLeave:M,onClick:w,onKeyDown:D,onKeyUp:Y},$=n(n({},t),{},{open:V,prefixCls:i,placement:c,autoFocus:m,keyboard:v,width:h,mask:g,maskClosable:b,inline:!1===k,afterOpenChange:function(e){var t,a;(L(e),null==N||N(e),e||!H.current||(null===(t=F.current)||void 0===t?void 0:t.contains(H.current)))||(null===(a=H.current)||void 0===a||a.focus({preventScroll:!0}))},ref:F},B);return e.createElement(I,{open:V||C||K,autoDestroy:!1,getContainer:k,autoLock:g&&(V||K)},e.createElement(U,$))},F=globalThis&&globalThis.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a};d("default","large");var H={distance:180};function B(n){var o=n.width,s=n.height,i=n.size,c=void 0===i?"default":i,u=n.closable,d=void 0===u||u,y=n.mask,g=void 0===y||y,x=n.push,b=void 0===x?H:x,k=n.closeIcon,C=void 0===k?e.createElement(h,null):k,N=n.bodyStyle,S=n.drawerStyle,j=n.className,E=n.visible,M=n.open,w=n.children,D=n.style,Y=n.title,O=n.headerStyle,I=n.onClose,T=n.footer,K=n.footerStyle,L=n.prefixCls,R=n.getContainer,z=n.extra,P=n.afterVisibleChange,A=n.afterOpenChange,U=F(n,["width","height","size","closable","mask","push","closeIcon","bodyStyle","drawerStyle","className","visible","open","children","style","title","headerStyle","onClose","footer","footerStyle","prefixCls","getContainer","extra","afterVisibleChange","afterOpenChange"]),B=e.useContext(m),$=B.getPopupContainer,_=B.getPrefixCls,W=B.direction,X=_("drawer",L),q=void 0===R&&$?function(){return $(document.body)}:R,Q=d&&e.createElement("button",{type:"button",onClick:I,"aria-label":"Close",className:"".concat(X,"-close")},C);[["visible","open"],["afterVisibleChange","afterOpenChange"]].forEach((function(e){var t=r(e,2);t[0],t[1]}));var J=a(l({"no-mask":!g},"".concat(X,"-rtl"),"rtl"===W),j),Z=e.useMemo((function(){return null!=o?o:"large"===c?736:378}),[o,c]),G=e.useMemo((function(){return null!=s?s:"large"===c?736:378}),[s,c]),ee={motionName:f(X,"mask-motion"),motionAppear:!0,motionEnter:!0,motionLeave:!0,motionDeadline:500};return e.createElement(p,null,e.createElement(v,{status:!0,override:!0},e.createElement(V,t({prefixCls:X,onClose:I},U,{open:null!=M?M:E,mask:g,push:b,width:Z,height:G,rootClassName:J,getContainer:q,afterOpenChange:function(e){null==A||A(e),null==P||P(e)},maskMotion:ee,motion:function(e){return{motionName:f(X,"panel-motion-".concat(e)),motionAppear:!0,motionEnter:!0,motionLeave:!0,motionDeadline:500}},rootStyle:D}),e.createElement("div",{className:"".concat(X,"-wrapper-body"),style:t({},S)},Y||d?e.createElement("div",{className:a("".concat(X,"-header"),l({},"".concat(X,"-header-close-only"),d&&!Y&&!z)),style:O},e.createElement("div",{className:"".concat(X,"-header-title")},Q,Y&&e.createElement("div",{className:"".concat(X,"-title")},Y)),z&&e.createElement("div",{className:"".concat(X,"-extra")},z)):null,e.createElement("div",{className:"".concat(X,"-body"),style:N},w),function(){if(!T)return null;var t="".concat(X,"-footer");return e.createElement("div",{className:t,style:K},T)}()))))}const{RangePicker:$}=M;function _(){const{t:t}=y();document.title="HADO CRM";const a=g((e=>e.app.powersCode)),[n,o]=e.useState([]),[r,s]=e.useState([]),[i,l]=e.useState(!1),[c,u]=O({pageNum:1,pageSize:10,total:0}),[d,m]=e.useState(x().format("YYYY-MM-DD")),[p,v]=e.useState(x().subtract(1,"days").format("YYYY-MM-DD")),[f,h]=O({provideruuid:void 0,storeuuid:void 0,stationuuid:void 0,startTime:void 0,endTime:void 0}),M=async e=>{const t={page:e.pageNum,limit:e.pageSize,agentuuid:f.provideruuid,provideruuid:f.storeuuid,stationuuid:f.stationuuid,starttime:f.startTime?f.startTime:x().subtract(1,"days").format("YYYY-MM-DD"),endtime:f.endTime?f.endTime:x().format("YYYY-MM-DD")};l(!0);try{const a=await D.gameList(t);a&&200===a.code?(o(a.data),u({total:a.cont,pageNum:e.pageNum,pageSize:e.pageSize})):S.error((null==a?void 0:a.message)??"error")}catch(a){}finally{l(!1)}},[I,L]=e.useState([]),[R,z]=e.useState([]),[P,A]=e.useState([]),[U,V]=e.useState(!1),F=e=>{V(!0),(async e=>{const t={gameuuid:e};l(!0);try{const e=await D.gameDetail(t);e&&200===e.code?s(e.data):S.error((null==e?void 0:e.message)??"error")}catch(a){}finally{l(!1)}})(e.gameid)},H=[{title:"gameid",dataIndex:"gameid",key:"gameid"},{title:t("blueTeam"),dataIndex:"blue",key:"blue"},{title:t("redTeam"),dataIndex:"red",key:"red"},{title:t("blueTeamScore"),dataIndex:"blueNum",key:"blueNum"},{title:t("redTeamScore"),dataIndex:"redNum",key:"redNum"},{title:t("game"),dataIndex:"game",key:"game"},{title:t("operatingMode"),dataIndex:"operate",key:"operate"},{title:t("updateTime"),dataIndex:"updateTime",key:"updateTime"},{title:t("action"),key:"control",width:200,render:(e,n)=>{const o=[];a.includes("record:see")&&o.push(b.jsx("span",{className:"control-btn blue",onClick:()=>F(n),children:b.jsx(k,{placement:"top",title:t("view"),children:b.jsx(T,{})})},"1"));const r=[];return o.forEach(((e,t)=>{t&&r.push(b.jsx(E,{type:"vertical"},`line${t}`)),r.push(e)})),r}}],_=[{title:t("team"),dataIndex:"ranks",key:"ranks"},{title:t("userNickname"),dataIndex:"username",key:"username"},{title:t("score"),dataIndex:"score",key:"score"},{title:t("pointsLost"),dataIndex:"losing",key:"losing"},{title:t("shield"),dataIndex:"shield",key:"shield"},{title:t("runningDistance"),dataIndex:"running",key:"running"},{title:t("calories"),dataIndex:"calorie",key:"calorie"},{title:t("hits"),dataIndex:"hitNum",key:"hitNum"},{title:t("defenseAttempts"),dataIndex:"defenseNum",key:"defenseNum"},{title:t("performancePoints"),dataIndex:"perScore",key:"perScore"}],W=e.useMemo((()=>null==n?void 0:n.map(((e,a)=>{const n=0===e.isworld?"HADO3V3":"HADOWORLD";return{key:a,uuid:e.uuid,gameid:e.gameuuidid,blue:e.blueresult,red:e.redresult,blueNum:e.bluescore,redNum:e.redscore,game:n,operate:t("normalMode"),updateTime:e.addtime}}))),[c,n]),X=e.useMemo((()=>r.map(((e,t)=>({key:e.id,ranks:e.teamname,username:e.username,score:e.kodata,losing:e.koeddata,shield:e.shiledtotal,running:e.runningkm,calorie:e.caldata,hitNum:e.accdata,defenseNum:e.guardblockcount,perScore:e.performancepoint})))),[r]),q={emptyText:t("noDataAvailable")};return e.useEffect((()=>{M(c),(async()=>{const e=(await w.getAgents()).data.map(((e,t)=>({label:e.providername,value:e.uuid,key:e.uuid})));L(e)})()}),[]),b.jsxs("div",{className:"store-list-box",children:[b.jsx("div",{className:"g-search",children:b.jsxs("ul",{className:"search-ul",children:[b.jsxs("div",{className:"search",children:[b.jsxs("li",{className:"search-item",children:[b.jsxs("span",{className:"item-lable",children:[t("distributor"),":"," "]}),b.jsx(C,{placeholder:t("pleaseSelect"),allowClear:!0,onChange:async e=>{h({provideruuid:e,storeuuid:void 0,stationuuid:void 0});const t=(await w.getStores({agenuuid:e})).data.map((e=>({label:e.providername,value:e.uuid,key:e.uuid})));z(t)},value:f.provideruuid,options:I})]}),b.jsxs("li",{className:"search-item",children:[b.jsxs("span",{className:"item-lable",children:[t("storeName"),":"]}),b.jsx(C,{placeholder:t("pleaseSelect"),allowClear:!0,onChange:async e=>{if(h({storeuuid:e,stationuuid:void 0}),e){const t=(await Y.getPlaygroundList({provideruuid:e})).data.map((e=>({key:e.uuid,label:e.stationname,value:e.uuid})));A(t)}else A([])},value:f.storeuuid,options:R})]}),b.jsxs("li",{className:"search-item",children:[b.jsxs("span",{className:"item-lable",children:[t("courtName"),":"]}),b.jsx(C,{placeholder:t("pleaseSelect"),allowClear:!0,onChange:e=>{h({stationuuid:e})},value:f.stationuuid,options:P})]}),b.jsxs("li",{className:"search-item",children:[b.jsxs("span",{className:"item-lable",children:[t("operatingMode"),":"]}),b.jsx(C,{placeholder:t("pleaseSelect"),allowClear:!0,options:[{value:"普通模式",label:t("normalMode")}]})]}),b.jsx("li",{className:"search-item",children:b.jsx($,{style:{marginLeft:20},onChange:e=>{h(e?{startTime:x(e[0]).format("YYYY-MM-DD"),endTime:x(e[1]).format("YYYY-MM-DD")}:{startTime:"",endTime:""})},defaultValue:[x(`${p}`,"YYYY-MM-DD"),x(`${d}`,"YYYY-MM-DD")],format:"YYYY-MM-DD",placeholder:[t("startDate"),t("endDate")]})})]}),a.includes("record:search")&&b.jsx("div",{children:b.jsx(N,{type:"primary",icon:b.jsx(K,{}),onClick:()=>{M(c)},children:t("search")})})]})}),b.jsx("div",{className:"diy-table",children:b.jsx(j,{columns:H,loading:i,locale:q,dataSource:W,pagination:{total:c.total,current:c.pageNum,pageSize:c.pageSize,showQuickJumper:!1,showTotal:e=>t("dataNumber",{count:e}),onChange:(e,t)=>((e,t)=>{M({pageNum:e,pageSize:t||c.pageSize})})(e,t)}})}),b.jsx(B,{onClose:()=>{V(!1)},open:U,placement:"bottom",closeIcon:!1,children:b.jsx(j,{columns:_,loading:i,locale:q,dataSource:X,pagination:!1})})]})}export{_ as default};
