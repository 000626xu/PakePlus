import{b as e,u as t,a as i,e as o,r as s,c as l,m as a,j as d,T as r,B as n}from"./index-aeca932e.js";import{F as u}from"./index-85dc0d3a.js";import{a as c}from"./index-801a9590.js";import"./index-d93151a5.js";import"./index-d90fa46f.js";import"./index-5a025839.js";import"./index-fb057fd6.js";import{P as m}from"./index-60197fbb.js";import{D as p}from"./index-a0588428.js";import{u as x}from"./user-a3dc1d16.js";import{s as j}from"./store-77f5b287.js";import{u as f}from"./useSetState-8e08c7f5.js";import{E as v}from"./EyeOutlined-d33bc3ff.js";import{E as g}from"./EditOutlined-21831c3e.js";import{D as y}from"./DeleteOutlined-c2326a92.js";import{P as h}from"./PlusCircleOutlined-90803570.js";import"./responsiveObserve-cfbf1a72.js";import"./index-5bcf51a7.js";import"./getScrollBarSize-6b2349d8.js";import"./isEqual-89fb4070.js";import"./useForceUpdate-c2b76191.js";import"./index-4a60c0a0.js";import"./index-73995e0d.js";import"./EyeOutlined-f0ed5c3d.js";import"./ActionButton-04036752.js";import"./DeleteOutlined-6b999003.js";function S(){const{t:S}=e();document.title="HADO CRM";const b=t(),N=i(),k=o((e=>e.app.powersCode));u.useForm();const[w,z]=s.useState([]),[I,O]=s.useState(!1),[C,P]=f({pageNum:1,pageSize:10,total:0});f({operateType:"add",nowData:null,modalShow:!1,modalLoading:!1}),s.useEffect((()=>{E(C),$(),F()}),[]);const $=()=>{const e=l.getAllMenusAndPowers().data;N.sys.reducerSetAllPowers(e)},E=async e=>{const t={page:e.pageNum,limit:e.pageSize};O(!0);try{const i=await j.getPlayList(t);i&&200===i.code?(z(i.data),P({total:i.cont,pageNum:e.pageNum,pageSize:e.pageSize})):a.error((null==i?void 0:i.message)??S("dataFetchFailed"))}finally{O(!1)}},A=(e,t)=>{b("add"===t?"/store/field/add":"up"===t?`/store/field/edit?field=${e.uuid}`:"price"===t?`/store/field/price?field=${e.uuid}&dai=${e.proxyId}&men=${e.storeId}`:`/store/field/detail?field=${null==e?void 0:e.uuid}`)},[D,T]=s.useState([]),F=async()=>{var e;const t=null==(e=(await x.getAgents()).data)?void 0:e.map((e=>({label:e.providername,value:e.uuid})));T(t)};s.useState([]);const B=[{title:S("number"),dataIndex:"serial",key:"serial"},{title:S("courtName"),dataIndex:"title",key:"title"},{title:S("storeName"),dataIndex:"store",key:"store"},{title:S("distributor"),dataIndex:"proxy",key:"proxy"},{title:S("businessHours"),dataIndex:"time",key:"time"},{title:S("maximumNumberOfPeople"),dataIndex:"limit",key:"limit"},{title:S("action"),key:"control",width:200,render:(e,t)=>{const i=[];k.includes("field:see")&&i.push(d.jsx("span",{className:"control-btn blue",onClick:()=>A(t,"see"),children:d.jsx(r,{placement:"top",title:S("view"),children:d.jsx(v,{})})},"field:see")),k.includes("field:edit")&&i.push(d.jsx("span",{className:"control-btn blue",onClick:()=>A(t,"up"),children:d.jsx(r,{placement:"top",title:S("edit"),children:d.jsx(g,{})})},"field:edit")),k.includes("field:del")&&i.push(d.jsx(m,{title:S("delete"),onConfirm:()=>(async e=>{O(!0);try{let t=await j.deletePlay({uuid:e.uuid});t&&200===t.code?(a.success("success"),E(C)):a.error((null==t?void 0:t.message)??"error")}finally{O(!1)}})(t),okText:S("confirm"),cancelText:S("cancel"),children:d.jsx("span",{className:"control-btn red",children:d.jsx(r,{placement:"top",title:S("delete"),children:d.jsx(y,{})})})},"field:del"));const o=[];return i.forEach(((e,t)=>{t&&o.push(d.jsx(p,{type:"vertical"},`line${t}`)),o.push(e)})),o}}],M=s.useMemo((()=>w.map(((e,t)=>{var i,o,s,l,a,d,r,n,u,c,m,p;return{key:e.uuid,uuid:e.uuid,serial:t+1+(C.pageNum-1)*C.pageSize,title:e.stationname,store:(null==(i=e.provider)?void 0:i.providername)||"-",storeId:null==(o=e.provider)?void 0:o.uuid,proxy:(null==(s=e.agentinfor)?void 0:s.providername)||"-",proxyId:null==(l=e.agentinfor)?void 0:l.uuid,time:`${(null==(a=null==e?void 0:e.stationintro)?void 0:a.start_time)||""}-${(null==(d=null==e?void 0:e.stationintro)?void 0:d.end_time)||""}`,limit:(null==(r=null==e?void 0:e.stationintro)?void 0:r.maxpeople)||"-",license:(null==(u=null==(n=null==e?void 0:e.codetoprovider)?void 0:n.codestruct)?void 0:u.regcode)||"-",goods:(null==(c=null==e?void 0:e.codetoprovider)?void 0:c.machinecode)||"-",status:null==(p=null==(m=null==e?void 0:e.codetoprovider)?void 0:m.codestruct)?void 0:p.statusreamk}}))),[C,w]),H={emptyText:S("noDataAvailable")};return d.jsxs("div",{className:"role-box",children:[d.jsx("div",{className:"g-search",children:d.jsx("ul",{className:"search-func",children:k.includes("field:add")&&d.jsx("li",{children:d.jsx(n,{type:"primary",icon:d.jsx(h,{}),disabled:!k.includes("field:add"),onClick:()=>A(null,"add"),children:S("addCourt")})})})}),d.jsx("div",{className:"diy-table",children:d.jsx(c,{columns:B,loading:I,locale:H,dataSource:M,pagination:{total:C.total,current:C.pageNum,pageSize:C.pageSize,showQuickJumper:!1,showTotal:e=>S("dataNumber",{count:e}),onChange:(e,t)=>((e,t)=>{E({pageNum:e,pageSize:t||C.pageSize})})(e,t)}})})]})}export{S as default};
