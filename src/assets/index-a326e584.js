import{r as e,A as a,_ as t,u as s,e as r,j as i,B as o,S as c,m as n,f as l,T as d}from"./index-aeca932e.js";import{F as m}from"./index-85dc0d3a.js";import{I as u}from"./index-d90fa46f.js";import{a as p}from"./index-801a9590.js";import"./index-d93151a5.js";import"./index-5a025839.js";import"./index-fb057fd6.js";import{P as h}from"./index-60197fbb.js";import{D as x}from"./index-a0588428.js";import{I as j}from"./index-a1eba122.js";import{u as f}from"./user-a3dc1d16.js";import{s as g}from"./store-77f5b287.js";import{t as v}from"./teacher-e39ee8aa.js";import{u as y}from"./useSetState-8e08c7f5.js";import{M as S}from"./index-6226197c.js";import{C as b}from"./CalendarOutlined-8ff6678f.js";import{P as w}from"./PlusCircleOutlined-90803570.js";import{E as T}from"./EditOutlined-21831c3e.js";import{D as k}from"./DisconnectOutlined-764e4556.js";import{C as N}from"./CheckOutlined-ab04c92f.js";import"./responsiveObserve-cfbf1a72.js";import"./index-73995e0d.js";import"./EyeOutlined-f0ed5c3d.js";import"./index-5bcf51a7.js";import"./getScrollBarSize-6b2349d8.js";import"./isEqual-89fb4070.js";import"./useForceUpdate-c2b76191.js";import"./index-4a60c0a0.js";import"./ActionButton-04036752.js";import"./Portal-0dc81ff6.js";var I=function(s,r){return e.createElement(a,t({},s,{ref:r,icon:b}))};const C=e.forwardRef(I);const z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M594.3 601.5a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1 8 8 0 008 8.4H407c4.2 0 7.6-3.3 7.9-7.5 3.8-50.6 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H661a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.7-126.1zM512 578c-28.5 0-51.7-23.3-51.7-52s23.2-52 51.7-52 51.7 23.3 51.7 52-23.2 52-51.7 52zm416-354H768v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H548v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H328v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H96c-17.7 0-32 14.3-32 32v576c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V256c0-17.7-14.3-32-32-32zm-40 568H136V296h120v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h120v496z"}}]},name:"contacts",theme:"outlined"};var P=function(s,r){return e.createElement(a,t({},s,{ref:r,icon:z}))};const E=e.forwardRef(P),{TextArea:O}=u,D={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:19}}};function F(){document.title="教练列表";const a=s(),t=r((e=>e.app.powersCode)),[b]=m.useForm(),[I,z]=e.useState([]),[P,F]=e.useState(!1),[H,$]=y({pageNum:1,pageSize:10,total:0}),[q,R]=y({operateType:"add",nowData:null,modalShow:!1,modalLoading:!1}),V=(e,t)=>{a("add"===t?"/store/teacher/add":"up"===t?`/store/teacher/edit?teacher=${null==e?void 0:e.uuid}`:"calendar"===t?`/store/teacher/work?teacher=${null==e?void 0:e.uuid}`:"leave"===t?`/store/teacher/leave?teacher=${null==e?void 0:e.uuid}`:`/store/detail?teacher=${null==e?void 0:e.uuid}`)},A=(b.validateFields(),async e=>{if(!t.includes("teacher:list"))return;const a={page:e.pageNum,limit:e.pageSize};F(!0);try{const t=await v.getTeacherList(a);t&&200===t.code?(z(t.data),$({total:t.cont,pageNum:e.pageNum,pageSize:e.pageSize})):n.error((null==t?void 0:t.message)??l("dataFetchFailed"))}finally{F(!1)}}),[B,L]=y(),[M,Q]=e.useState([]),[U,_]=e.useState([]);const J=[{title:"编号",dataIndex:"serial",key:"serial"},{title:"教练名称",dataIndex:"teacherName",key:"teacherName"},{title:"所属门店",dataIndex:"store",key:"store"},{title:"所属代理",dataIndex:"storeProxy",key:"storeProxy"},{title:"教练价格",dataIndex:"teacherPrice",key:"teacherPrice"},{title:"教练介绍",dataIndex:"teacherDesc",key:"teacherDesc"},{title:"教练时间",dataIndex:"teacherTime",key:"teacherTime"},{title:"教练状态",dataIndex:"teacherStatus",key:"teacherStatus"},{title:"创建时间",dataIndex:"createTime",key:"createTime"},{title:"操作",key:"control",width:200,render:(e,a)=>{const s=[];t.includes("teacher:work")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>V(a,"calendar"),children:i.jsx(d,{placement:"top",title:"日程",children:i.jsx(C,{})})},"1")),t.includes("teacher:leave")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>V(a,"leave"),children:i.jsx(d,{placement:"top",title:"假勤",children:i.jsx(E,{})})},"2")),t.includes("teacher:edit")&&s.push(i.jsx("span",{className:"control-btn blue",onClick:()=>V(a,"up"),children:i.jsx(d,{placement:"top",title:"编辑",children:i.jsx(T,{})})},"3")),t.includes("teacher:cold")&&s.push(i.jsx(h,{title:1===a.status?"确定设置为在职吗？":"确定设置为离职吗？",onConfirm:()=>(async e=>{F(!0);try{let a=await v.editTeacherStatus({coachuuid:e.uuid,status:1===e.status?0:1});a&&200===a.code?(n.success(l("operationSuccessful")),A(H)):n.error((null==a?void 0:a.message)??"操作失败")}finally{F(!1)}})(a),okText:"确定",cancelText:"取消",children:i.jsx("span",{className:"control-btn red",children:i.jsx(d,{placement:"top",title:0===B?"在职":"离职",children:1===a.status?i.jsx(k,{}):i.jsx(N,{style:{color:"green"}})})})},"4"));const r=[];return s.forEach(((e,a)=>{a&&r.push(i.jsx(x,{type:"vertical"},`line${a}`)),r.push(e)})),r}}],X=e.useMemo((()=>I.map(((e,a)=>{return{key:e.id,uuid:e.uuid,serial:a+1+(H.pageNum-1)*H.pageSize,teacherName:e.coachname,store:e.storename,storeProxy:e.providername,teacherPrice:e.coachprice,teacherDesc:e.coachintro,teacherTime:(t=e.workingday,t.split(",").map((e=>function(e){switch(e){case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六";case 7:return"周日";default:return}}(parseInt(e)))).join(", ")),teacherStatus:0===e.status?"在职":"离职",createTime:e.addtime,status:e.status};var t}))),[H,I]);return e.useEffect((()=>{A(H),(async()=>{await g.getStoreType()})(),(async()=>{const e=(await f.getAgents()).data.map((e=>({label:e.providername,value:e.uuid})));Q(e)})()}),[]),i.jsxs("div",{className:"store-list-box",children:[i.jsx("div",{className:"g-search",children:i.jsx("ul",{className:"search-func",children:t.includes("teacher:add")&&i.jsx("li",{children:i.jsx(o,{type:"primary",icon:i.jsx(w,{}),disabled:!t.includes("teacher:add"),onClick:()=>V(null,"add"),children:"新增教练"})})})}),i.jsx("div",{className:"diy-table",children:i.jsx(p,{columns:J,loading:P,dataSource:X,pagination:{total:H.total,current:H.pageNum,pageSize:H.pageSize,showQuickJumper:!1,showTotal:e=>`共 ${e} 条数据`,onChange:(e,a)=>((e,a)=>{A({pageNum:e,pageSize:a||H.pageSize})})(e,a)}})}),i.jsx(S,{title:{add:"新增教练",up:"编辑角色",see:"查看"}[q.operateType],open:q.modalShow,cancelText:"取消",okText:"确认",onCancel:()=>(b.setFieldsValue({rolename:"",proxy:"",store:"",desc:"",limit:""}),void R({modalShow:!1})),confirmLoading:q.modalLoading,children:i.jsxs(m,{form:b,initialValues:{formConditions:1},children:[i.jsx(m.Item,{label:"教练名称",name:"rolename",...D,rules:[{required:!0,whitespace:!0,message:"请输入教练名称"},{max:20,message:"最多输入20位字符"}],children:i.jsx(u,{placeholder:"请输入教练名",disabled:"see"===q.operateType})}),i.jsx(m.Item,{label:"所属代理",name:"proxy",...D,rules:[{required:!0,message:"请选择所属代理"}],children:i.jsx(c,{disabled:"see"===q.operateType,options:M,onSelect:async e=>{const a=(await f.getStores({agenuuid:e})).data.map((e=>({label:e.providername,value:e.uuid})));_(a)},placeholder:"请选择所属代理"})}),i.jsx(m.Item,{label:"所属门店",name:"store",...D,rules:[{required:!0,message:"请选择所属门店"}],children:i.jsx(c,{disabled:"see"===q.operateType,options:U,placeholder:"请选择所属门店"})}),i.jsx(m.Item,{label:"角色描述",name:"desc",...D,rules:[{max:200,message:"最多输入200个字符"},{required:!0,message:"请输入角色描述"}],children:i.jsx(O,{rows:4,disabled:"see"===q.operateType,autoSize:{minRows:2,maxRows:6}})}),i.jsx(m.Item,{label:"数量限制",name:"limit",...D,rules:[{required:!0,message:"请输入数量限制"}],children:i.jsx(j,{min:0,max:99,style:{width:"100%"},disabled:"see"===q.operateType})})]})})]})}export{F as default};
